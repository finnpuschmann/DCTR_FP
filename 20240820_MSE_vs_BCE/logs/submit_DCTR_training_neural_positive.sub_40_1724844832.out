Configured CUDA from: /cvmfs/sft.cern.ch/lcg/releases/cuda/12.4-4899e/x86_64-el9-gcc11-opt
GPUs available for tensorflow:
[]
loading data
preparing data
setting up neural network and starting training
Epoch 1/100

Epoch 1: val_loss improved from inf to 0.61888, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 59s - loss: 0.6422 - acc: 0.4999 - val_loss: 0.6189 - val_acc: 0.5004 - lr: 0.0010 - 59s/epoch - 959ms/step
Epoch 2/100

Epoch 2: val_loss improved from 0.61888 to 0.61775, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 58s - loss: 0.6184 - acc: 0.4999 - val_loss: 0.6177 - val_acc: 0.5002 - lr: 0.0010 - 58s/epoch - 932ms/step
Epoch 3/100

Epoch 3: val_loss improved from 0.61775 to 0.61731, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6176 - acc: 0.4999 - val_loss: 0.6173 - val_acc: 0.5004 - lr: 0.0010 - 57s/epoch - 912ms/step
Epoch 4/100

Epoch 4: val_loss improved from 0.61731 to 0.61708, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6173 - acc: 0.4999 - val_loss: 0.6171 - val_acc: 0.5001 - lr: 0.0010 - 56s/epoch - 904ms/step
Epoch 5/100

Epoch 5: val_loss improved from 0.61708 to 0.61685, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6171 - acc: 0.4999 - val_loss: 0.6168 - val_acc: 0.5003 - lr: 0.0010 - 56s/epoch - 902ms/step
Epoch 6/100

Epoch 6: val_loss improved from 0.61685 to 0.61675, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6169 - acc: 0.4999 - val_loss: 0.6168 - val_acc: 0.5001 - lr: 0.0010 - 56s/epoch - 901ms/step
Epoch 7/100

Epoch 7: val_loss improved from 0.61675 to 0.61660, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 55s - loss: 0.6168 - acc: 0.4999 - val_loss: 0.6166 - val_acc: 0.5001 - lr: 0.0010 - 55s/epoch - 894ms/step
Epoch 8/100

Epoch 8: val_loss improved from 0.61660 to 0.61653, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6167 - acc: 0.4999 - val_loss: 0.6165 - val_acc: 0.5001 - lr: 0.0010 - 57s/epoch - 914ms/step
Epoch 9/100

Epoch 9: val_loss improved from 0.61653 to 0.61649, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6166 - acc: 0.4999 - val_loss: 0.6165 - val_acc: 0.5002 - lr: 0.0010 - 57s/epoch - 918ms/step
Epoch 10/100

Epoch 10: val_loss did not improve from 0.61649
62/62 - 54s - loss: 0.6165 - acc: 0.4999 - val_loss: 0.6165 - val_acc: 0.5002 - lr: 0.0010 - 54s/epoch - 874ms/step
Epoch 11/100

Epoch 11: val_loss improved from 0.61649 to 0.61641, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6165 - acc: 0.4999 - val_loss: 0.6164 - val_acc: 0.5001 - lr: 0.0010 - 56s/epoch - 897ms/step
Epoch 12/100

Epoch 12: val_loss improved from 0.61641 to 0.61630, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6164 - acc: 0.4999 - val_loss: 0.6163 - val_acc: 0.5002 - lr: 0.0010 - 56s/epoch - 905ms/step
Epoch 13/100

Epoch 13: val_loss improved from 0.61630 to 0.61628, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6164 - acc: 0.4999 - val_loss: 0.6163 - val_acc: 0.5003 - lr: 0.0010 - 56s/epoch - 900ms/step
Epoch 14/100

Epoch 14: val_loss did not improve from 0.61628
62/62 - 55s - loss: 0.6163 - acc: 0.4999 - val_loss: 0.6164 - val_acc: 0.5003 - lr: 0.0010 - 55s/epoch - 879ms/step
Epoch 15/100

Epoch 15: val_loss improved from 0.61628 to 0.61626, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 64s - loss: 0.6163 - acc: 0.4999 - val_loss: 0.6163 - val_acc: 0.4999 - lr: 0.0010 - 64s/epoch - 1s/step
Epoch 16/100

Epoch 16: val_loss improved from 0.61626 to 0.61618, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6163 - acc: 0.4999 - val_loss: 0.6162 - val_acc: 0.5004 - lr: 0.0010 - 56s/epoch - 898ms/step
Epoch 17/100

Epoch 17: val_loss did not improve from 0.61618
62/62 - 54s - loss: 0.6163 - acc: 0.4999 - val_loss: 0.6162 - val_acc: 0.4997 - lr: 0.0010 - 54s/epoch - 872ms/step
Epoch 18/100

Epoch 18: val_loss did not improve from 0.61618
62/62 - 54s - loss: 0.6163 - acc: 0.4999 - val_loss: 0.6162 - val_acc: 0.5003 - lr: 0.0010 - 54s/epoch - 874ms/step
Epoch 19/100

Epoch 19: val_loss improved from 0.61618 to 0.61617, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6162 - acc: 0.4999 - val_loss: 0.6162 - val_acc: 0.5001 - lr: 0.0010 - 56s/epoch - 903ms/step
Epoch 20/100

Epoch 20: val_loss improved from 0.61617 to 0.61611, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 55s - loss: 0.6162 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.5002 - lr: 0.0010 - 55s/epoch - 894ms/step
Epoch 21/100

Epoch 21: val_loss improved from 0.61611 to 0.61611, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6162 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.5002 - lr: 0.0010 - 57s/epoch - 927ms/step
Epoch 22/100

Epoch 22: val_loss improved from 0.61611 to 0.61610, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf

Epoch 22: ReduceLROnPlateau reducing learning rate to 0.0006000000284984708.
62/62 - 56s - loss: 0.6162 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5000 - lr: 0.0010 - 56s/epoch - 905ms/step
Epoch 23/100

Epoch 23: val_loss improved from 0.61610 to 0.61609, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5002 - lr: 6.0000e-04 - 56s/epoch - 897ms/step
Epoch 24/100

Epoch 24: val_loss improved from 0.61609 to 0.61609, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6161 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.5000 - lr: 6.0000e-04 - 57s/epoch - 920ms/step
Epoch 25/100

Epoch 25: val_loss improved from 0.61609 to 0.61608, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 62s - loss: 0.6161 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.4999 - lr: 6.0000e-04 - 62s/epoch - 993ms/step
Epoch 26/100

Epoch 26: val_loss improved from 0.61608 to 0.61607, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 57s - loss: 0.6161 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.5000 - lr: 6.0000e-04 - 57s/epoch - 917ms/step
Epoch 27/100

Epoch 27: val_loss improved from 0.61607 to 0.61606, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 58s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5001 - lr: 6.0000e-04 - 58s/epoch - 929ms/step
Epoch 28/100

Epoch 28: val_loss did not improve from 0.61606
62/62 - 54s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6162 - val_acc: 0.5004 - lr: 6.0000e-04 - 54s/epoch - 877ms/step
Epoch 29/100

Epoch 29: val_loss improved from 0.61606 to 0.61606, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5001 - lr: 6.0000e-04 - 56s/epoch - 895ms/step
Epoch 30/100

Epoch 30: val_loss improved from 0.61606 to 0.61606, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.4999 - lr: 6.0000e-04 - 56s/epoch - 909ms/step
Epoch 31/100

Epoch 31: val_loss did not improve from 0.61606

Epoch 31: ReduceLROnPlateau reducing learning rate to 0.0003600000170990825.
62/62 - 54s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5000 - lr: 6.0000e-04 - 54s/epoch - 875ms/step
Epoch 32/100

Epoch 32: val_loss did not improve from 0.61606
62/62 - 55s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.4998 - lr: 3.6000e-04 - 55s/epoch - 885ms/step
Epoch 33/100

Epoch 33: val_loss improved from 0.61606 to 0.61605, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 59s - loss: 0.6161 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5001 - lr: 3.6000e-04 - 59s/epoch - 947ms/step
Epoch 34/100

Epoch 34: val_loss did not improve from 0.61605
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.4998 - lr: 3.6000e-04 - 56s/epoch - 907ms/step
Epoch 35/100

Epoch 35: val_loss improved from 0.61605 to 0.61604, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5001 - lr: 3.6000e-04 - 56s/epoch - 902ms/step
Epoch 36/100

Epoch 36: val_loss improved from 0.61604 to 0.61604, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6160 - acc: 0.4999 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 3.6000e-04 - 56s/epoch - 901ms/step
Epoch 37/100

Epoch 37: val_loss did not improve from 0.61604

Epoch 37: ReduceLROnPlateau reducing learning rate to 0.00021600000327453016.
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5003 - lr: 3.6000e-04 - 54s/epoch - 875ms/step
Epoch 38/100

Epoch 38: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5002 - lr: 2.1600e-04 - 54s/epoch - 872ms/step
Epoch 39/100

Epoch 39: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5002 - lr: 2.1600e-04 - 55s/epoch - 885ms/step
Epoch 40/100

Epoch 40: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.4999 - val_loss: 0.6160 - val_acc: 0.5001 - lr: 2.1600e-04 - 55s/epoch - 887ms/step
Epoch 41/100

Epoch 41: val_loss improved from 0.61604 to 0.61604, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4999 - lr: 2.1600e-04 - 56s/epoch - 903ms/step
Epoch 42/100

Epoch 42: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.4999 - val_loss: 0.6161 - val_acc: 0.5001 - lr: 2.1600e-04 - 54s/epoch - 872ms/step
Epoch 43/100

Epoch 43: val_loss did not improve from 0.61604

Epoch 43: ReduceLROnPlateau reducing learning rate to 0.00012960000021848827.
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5001 - lr: 2.1600e-04 - 54s/epoch - 875ms/step
Epoch 44/100

Epoch 44: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.4997 - lr: 1.2960e-04 - 54s/epoch - 876ms/step
Epoch 45/100

Epoch 45: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6161 - val_acc: 0.5001 - lr: 1.2960e-04 - 54s/epoch - 874ms/step
Epoch 46/100

Epoch 46: val_loss did not improve from 0.61604
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5001 - lr: 1.2960e-04 - 56s/epoch - 907ms/step
Epoch 47/100

Epoch 47: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4999 - lr: 1.2960e-04 - 55s/epoch - 885ms/step
Epoch 48/100

Epoch 48: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 1.2960e-04 - 54s/epoch - 875ms/step
Epoch 49/100

Epoch 49: val_loss improved from 0.61604 to 0.61604, saving model to ./saved_models/DCTR_NNLO_cce_pos_rwgt_1_batchsize_262144.tf

Epoch 49: ReduceLROnPlateau reducing learning rate to 7.775999838486313e-05.
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 1.2960e-04 - 55s/epoch - 895ms/step
Epoch 50/100

Epoch 50: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 7.7760e-05 - 54s/epoch - 875ms/step
Epoch 51/100

Epoch 51: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 7.7760e-05 - 54s/epoch - 874ms/step
Epoch 52/100

Epoch 52: val_loss did not improve from 0.61604
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4999 - lr: 7.7760e-05 - 56s/epoch - 895ms/step
Epoch 53/100

Epoch 53: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4998 - lr: 7.7760e-05 - 55s/epoch - 882ms/step
Epoch 54/100

Epoch 54: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 7.7760e-05 - 54s/epoch - 876ms/step
Epoch 55/100

Epoch 55: val_loss did not improve from 0.61604

Epoch 55: ReduceLROnPlateau reducing learning rate to 4.6655999904032795e-05.
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 7.7760e-05 - 54s/epoch - 872ms/step
Epoch 56/100

Epoch 56: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4997 - lr: 4.6656e-05 - 54s/epoch - 871ms/step
Epoch 57/100

Epoch 57: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4999 - lr: 4.6656e-05 - 54s/epoch - 876ms/step
Epoch 58/100

Epoch 58: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 4.6656e-05 - 55s/epoch - 883ms/step
Epoch 59/100

Epoch 59: val_loss did not improve from 0.61604
62/62 - 56s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 4.6656e-05 - 56s/epoch - 896ms/step
Epoch 60/100

Epoch 60: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4998 - lr: 4.6656e-05 - 54s/epoch - 874ms/step
Epoch 61/100

Epoch 61: val_loss did not improve from 0.61604

Epoch 61: ReduceLROnPlateau reducing learning rate to 2.799360081553459e-05.
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 4.6656e-05 - 54s/epoch - 872ms/step
Epoch 62/100

Epoch 62: val_loss did not improve from 0.61604
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 2.7994e-05 - 54s/epoch - 871ms/step
Epoch 63/100

Epoch 63: val_loss did not improve from 0.61604
62/62 - 55s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.4997 - lr: 2.7994e-05 - 55s/epoch - 888ms/step
Epoch 64/100

Epoch 64: val_loss did not improve from 0.61604
Restoring model weights from the end of the best epoch: 49.
62/62 - 54s - loss: 0.6160 - acc: 0.5000 - val_loss: 0.6160 - val_acc: 0.5000 - lr: 2.7994e-05 - 54s/epoch - 872ms/step
Epoch 64: early stopping
clearing keras session and collecting garbage
finished training: loss = 'cce', run = 1, batch_size = 262144
